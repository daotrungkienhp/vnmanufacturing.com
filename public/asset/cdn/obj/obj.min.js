var net=(net=net||{})||{},net=(!function(){"use strict";var e=net.util=net.util||{};e.get=function(e,t){var n=e.indexOf("-"),n=0<n?e.slice(0,n):e,n=net.user.getUserAccessInfo(n),o=(e=`https://${n.host}/obj/`+e,new XMLHttpRequest);o.onreadystatechange=function(){4===this.readyState&&(200===this.status?t(this.responseText):t(""))},o.open("GET",e,!0),n.utk&&o.setRequestHeader("utk",n.utk),o.send()},e.post=function(e,t,n,o){"search"===e&&n.where&&(n.where=function(e){if("string"!=typeof e)return e;var t,n,o=e.split(/[&|]/g).filter(Boolean),e="||"===e[o[0].length]?"or":"and",r=[];for(var s=o.length-1;0<=s;s--)n=o[s],t=n.split(/>=|<=|<>|!=|>|<|=/g).filter(Boolean),n=a[n.substring(t[0].length,n.length-t[1].length)],t[1]=t[1].trim(),'""'!==t[1]&&"''"!==t[1]||(t[1]=""),r.push({name:t[0].trim(),op:n,val:t[1]});return{[e]:r}}(n.where));var e=`https://${t.host}/obj/`+e,r=new XMLHttpRequest;r.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE&&200!=this.status)return o({code:1,error:this.status});if(this.readyState==XMLHttpRequest.DONE&&200==this.status){let e={};try{(e=JSON.parse(this.responseText)).data&&(e.data=function(e){if(e){if(e.list&&Array.isArray(e.list))for(var t=e.list,n=t.length-1;0<=n;n--)t[n]=o(t[n]);"object"==typeof e&&(e=o(e))}return e;function o(e){for(var t in e)if(e.hasOwnProperty(t)&&"string"==typeof(n=e[t])&&("{"===n[0]||"["===n[0]))try{e[t]=JSON.parse(e[t])}catch(e){console.log(e)}var n;return e}}(e.data))}catch(e){}return o(e||{code:1,error:this.responseText})}},r.open("POST",e,!0),r.setRequestHeader("Content-type","application/json;charset=UTF-8"),t.utk&&r.setRequestHeader("utk",t.utk),r.send(function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]?t[n]=JSON.stringify(e[n]):t[n]=e[n]);return JSON.stringify(t)}(n))};const a={">=":"ge","<=":"le","<>":"ct","!=":"ne",">":"gt","<":"lt","=":"eq"}}(),net||{}),net=(!function(){"use strict";var a=net.user=net.user||{cached:{},config:{},get root(){return net.os2}},r=a.cached;function c(){localStorage.setItem("utk",net.os2.utk),a.currentContainer&&localStorage.setItem("ctr",a.currentContainer)}function i(e){var t=forge.md.sha512.sha256.create();return t.update(e),t.digest().toHex()}a.isLogged=function(){return net.os2&&net.os2.utk&&net.os2.host},a.register=function(e,t,n,o){e={userId:e},t&&(e.password=i(t)),n&&(e.containerId=n),t={host:net.os2.host};net.util.post("user-register",t,e,e=>{o(e)})},a.login=function(e,t,s){e={userId:e,password:i(t)},t={host:net.os2.host};net.util.post("user-login",t,e,o=>{if(0!==o.code)return s(o);var e=o.data||{};net.os2.utk=e.utk,net.os2.loc=(e.utk||"").slice(129);{var r=()=>{c(),a.loadSession(()=>{s(o)})};let e=net.os2.utk,t=e.slice(129)+"/user-config.json",n={};net.util.get(t,e=>{try{n=JSON.parse(e)}catch(e){}a.config=n,a.currentContainer||(a.currentContainer=n.defaultContainer||net.os2.containerId),r()})}})},a.getUserAccessInfo=function(e){var t;return e&&e.startsWith("0x00190x")?{host:"s1.thechangan.net",containerId:"0x00190x"}:e&&e.startsWith("0x00190x")?{host:"s1.thechangan.net",containerId:"0x00190x"}:e&&0!==e.indexOf(net.os2.containerId)?(e=(t=e.indexOf("-"))<0?e:e.slice(0,t),r[e]):net.os2},a.clearSession=function(){localStorage.removeItem("utk"),localStorage.removeItem("ctr"),delete net.os2.utk,delete a.currentContainer,location.reload()},a.loadSession=function(e){let t=localStorage.getItem("utk");var n,o=localStorage.getItem("ctr");t?(net.os2.utk=t,net.os2.loc=(t||"").slice(129),a.currentContainer=o,n=()=>{e&&e()},o=t.slice(129)+"/containers.json",net.util.get(o,e=>{try{let t=JSON.parse(e),n;Object.keys(t).forEach(e=>{"0"===e[0]&&(n=t[e].split(","),r[e]={containerId:e,host:n[0],utk:n[1],loc:n[2]})})}catch(e){}n()})):e&&e()},a.switchToContainer=function(e,t){e!==net.os2.containerId&&!r[e]||(a.currentContainer=e,c()),t&&location.reload()}}(),net||{}),net=(!function(){"use strict";var r=net.util,o=net.obj=net.obj||{},u=net.user.getUserAccessInfo;o.new=function(e,t,n=0){var t=t||net.user.currentContainer,o=net.obj.schema[e]||{};return o.spaceLoc=t+"-"+e,o},o.spaceLoc=function(e,t){return`${t||net.user.currentContainer}-`+e},o.save=function(e,t){var n=u(e.loc||e.spaceLoc);if(e.loc)return r.post("update",n,e,t);r.post("insert",n,e,t)},o.get=function(e,t){var n=u(e);r.post("get",n,{loc:e},t)},o.remove=function(e,t){var n=u(e);r.post("remove",n,{loc:e},t)},o.search=function(e,t){var n=u(e.spaceLoc);r.post("search",n,e,t)},o.getList=function(e,t){var n=u(e);r.post("get-list",n,{locs:e},t)},o.removeList=function(e,t){var n=u(e);r.post("remove-list",n,{locs:e},t)},o.shareObjectItem=function(e,t,n){var o=u(e);t.loc=e,r.post("share-object-item",o,t,n)},o.unshareObjectItem=function(e,t,n){o.shareObjectItem(e,t,n)},o.publicObjectItem=function(e,t,n){o.shareObjectItem(e,{userIds:"guest",accessRight:{read:1},subnames:t},n)},o.unpublicObjectItem=function(e,t,n){o.unshareObjectItem(e,{userIds:"*",subnames:t},n)},o.shareObjectSpace=function(e,t,n){var o=u(e);t.spaceLoc=e,r.post("share-object-space",o,t,n)},o.unshareObjectSpace=function(e,t){var n=u(e);r.post("unshare-object-space",n,{spaceLoc:e},t)},o.addFileToObject=function(e,t,n,o,r){if(!e)return o({code:1,error:"Invalid request"});var s=u(e);let a=`https://${s.host}/obj/add-file-to-object`;a+="?loc="+e,t&&(a+="&folder="+t);const c=new FormData,i=(Array.from(n).forEach(e=>{c.append("files",e)}),new XMLHttpRequest);i.onload=()=>{var e=JSON.parse(i.responseText);o(e)};return i.open("POST",a),s.utk&&i.setRequestHeader("utk",s.utk),i.send(c),i},o.removeFileOfObject=function(e,t,n){var o=u(e);r.post("remove-file-of-object",o,{loc:e,file:t},n)},o.addDataSegmentToFile=function(e,t,n){var o=u(e);t.loc=e,r.post("add-data-segment-to-file",o,t,n)},o.removeDataSegmentFromFile=function(e,t,n){var o=u(e);t.loc=e,r.post("remove-data-segment-from-file",o,t,n)}}(),net||{}),net=(!function(){"use strict";net.util;var e=net.ctr=net.ctr||{},o=net.user.getUserAccessInfo;e.createContainer=function(n){var e=net.user.getUserAccessInfo(net.os2.containerId);net.util.post("create-container",e,{},e=>{var t;0===e.code&&(t=e.data,net.user.cached[t.containerId]=t),n(e)})},e.removeContainer=function(e,t){var n=o(net.os2.containerId);net.util.post("remove-container",n,{},e=>{t(e)})}}(),net||{}),net=(!function(){"use strict";net.util,net.obj=net.obj||{}}(),net||{}),net=(!function(){"use strict";var c=net.util;c.addCTRID,net.obj=net.obj||{};net.onNotify=function(e){function t(){var e={esid:r};c.post(s+"/ping",e,e=>{var t;e.news?(t={esid:r},c.post(s+"/ask",t,e=>{var t;0===e.code&&(r=e.esid,t=e.data,o.forEach(e=>{e&&e(t)})),n()})):(a=e.code?++a:3,r=e.esid,n())})}function n(){setTimeout(function(){0<o.length&&t()},1e3*a)}var o,r,s,a;net.__notifier||(net.__notifier=(o=[],r=function(){var e=(net.user.links||"").split(",").filter(Boolean).map(e=>e+",-1").join(",");return e=net.user.ctr+",-1"+(e?","+e:""),console.log("esid",e),e}(),s=location.origin,a=3,{register:function(e){e&&(o.push(e),n())}})),net.__notifier.register(e)}}(),net||{}),net=(!function(){"use strict";net.obj=net.obj||{},net.obj.schema||(net.obj.schema={user:{userId:"user@domain.com",token:"",passOrg:"",accessRights:"userId,containerid-data_access_permit-x-y-z"},server:{ip:"xx.yy.zz.tt",name:"si.thechangan.com",serverId:"si"},container:{name:"",containerId:"0x....0x",userId:"user@domain.com",userLoc:"container-user-x-y-z",host:"serverId.domain.com"},product:{name:"",sku:""},message:{name:"",content:""},domain:{name:"domain.com",webLoc:""}})}(),net||{});!function(){"use strict";net.util;var e=net.store=net.store||{};net.user.getUserAccessInfo;e.createStore=function(r){net.ctr.createContainer(e=>{if(0!==e.code)return r(e);e=e.data,net.user.switchToContainer(e.containerId),e={name:"My Store",title:"My Store",language:"en-US",country:"us",timezone:"America/Los_Angeles",owner:net.user.root.loc,spaceLoc:net.obj.spaceLoc("store")};net.obj.save(e,e=>{if(0!==e.code)return r(e);{var n=e.data.loc,o=()=>{r(e)};let t={dataId:"owner",dataSegment:net.user.root.loc,filePath:"profile.json"};net.obj.addDataSegmentToFile(n,t,e=>{t.filePath="config.json",net.obj.addDataSegmentToFile(n,t,e=>{o()})})}})})}}();